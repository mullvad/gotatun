[package]
name = "gotatun"
description = "an implementation of the WireGuardÂ® protocol designed for portability and speed"
version = "0.2.0"
authors.workspace = true
rust-version.workspace = true
edition.workspace = true
repository.workspace = true
license.workspace = true
categories = ["network-programming", "asynchronous"]
keywords = ["wireguard", "vpn"]
readme.workspace = true

[features]
default = []
device = ["thiserror"]
pcap = ["dep:pcap-file"]
# UDP GRO appears to be broken on Windows.
# In some cases it fails to return UDP_COALESCED_INFO
windows-gro = []
daita = []
# Add non-compliant UAPI support for DAITA.
# See `UAPI.md` for details.
daita-uapi = ["daita"]

[dependencies]
base64 = { workspace = true }
hex = { workspace = true }
libc = { workspace = true }
parking_lot = { workspace = true }
ipnetwork = { workspace = true }
ip_network = { workspace = true }
ip_network_table = { workspace = true }
ring = { workspace = true }
x25519-dalek = { workspace = true, features = [
    "reusable_secrets",
    "static_secrets",
] }
rand_core = { workspace = true, features = ["getrandom"] }
chacha20poly1305 = { workspace = true }
aead = { workspace = true }
blake2 = { workspace = true }
hmac = { workspace = true }
mock_instant = { workspace = true, optional = true }
socket2 = { workspace = true, features = ["all"] }
thiserror = { workspace = true, optional = true }
tokio = { workspace = true, features = ["full"] }
eyre = { workspace = true }
log = { workspace = true }
typed-builder = { workspace = true }
tun = { workspace = true, features = ["async"], optional = true }
zerocopy = { workspace = true, features = ["std", "derive"] }
pnet_packet = { workspace = true }
bytes = { workspace = true }
either = { workspace = true }
bitfield-struct = { workspace = true }
rand = { workspace = true }

pcap-file = { workspace = true, optional = true }
duplicate = { workspace = true }
constant_time_eq = { workspace = true }
futures = { workspace = true }
maybenot = { workspace = true }
rand_chacha = { workspace = true } 

[target.'cfg(target_os = "windows")'.dependencies]
windows-sys = { workspace = true, features = [
    "Win32",
    "Win32_Foundation",
    "Win32_Networking",
    "Win32_Networking_WinSock",
    "Win32_System_IO",
] }

[target.'cfg(unix)'.dependencies]
nix = { workspace = true, default-features = false, features = [
    "fs",
    "time",
    "user",
    "socket",
    "uio",
    "net",
] }

[dev-dependencies]
etherparse = { workspace = true }
criterion = { workspace = true, features = ["html_reports"] }

[lib]
crate-type = ["staticlib", "cdylib", "rlib"]

[[bench]]
name = "crypto_benches"
harness = false

[[bench]]
name = "throughput_benches"
harness = false
